<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>一、 编程规约 | Java 编程规范</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="Java 代码整洁之道">
    <link rel="preload" href="/assets/css/0.styles.f69a04f2.css" as="style"><link rel="preload" href="/assets/js/app.ebef3189.js" as="script"><link rel="preload" href="/assets/js/2.6bb482e9.js" as="script"><link rel="preload" href="/assets/js/11.e3e93c84.js" as="script"><link rel="prefetch" href="/assets/js/10.43cf8674.js"><link rel="prefetch" href="/assets/js/12.2916cd62.js"><link rel="prefetch" href="/assets/js/13.e0e9bcc6.js"><link rel="prefetch" href="/assets/js/14.134f0f23.js"><link rel="prefetch" href="/assets/js/15.ebf872e0.js"><link rel="prefetch" href="/assets/js/16.97604c24.js"><link rel="prefetch" href="/assets/js/17.f0da6ac9.js"><link rel="prefetch" href="/assets/js/18.683dd516.js"><link rel="prefetch" href="/assets/js/19.ac74fe53.js"><link rel="prefetch" href="/assets/js/20.16fbc1d6.js"><link rel="prefetch" href="/assets/js/21.1613b491.js"><link rel="prefetch" href="/assets/js/22.532d3087.js"><link rel="prefetch" href="/assets/js/3.b925be4d.js"><link rel="prefetch" href="/assets/js/4.42e5e5a2.js"><link rel="prefetch" href="/assets/js/5.00bc1fc7.js"><link rel="prefetch" href="/assets/js/6.8cf3236e.js"><link rel="prefetch" href="/assets/js/7.ee76a0f8.js"><link rel="prefetch" href="/assets/js/8.52beb9ac.js"><link rel="prefetch" href="/assets/js/9.d93f00cf.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f69a04f2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Java 编程规范</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/alibaba/" class="nav-link router-link-active">
  阿里规范
</a></div><div class="nav-item"><a href="/google/" class="nav-link">
  谷歌规范
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="选择语言" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/alibaba/java-specification.html" class="nav-link router-link-exact-active router-link-active">
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="/en/" class="nav-link">
  English
</a></li></ul></div></div> <a href="https://github.com/programmingStyle/java.programming.style" target="_blank" rel="noopener noreferrer" class="repo-link">
    Java Programming Style
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/alibaba/" class="nav-link router-link-active">
  阿里规范
</a></div><div class="nav-item"><a href="/google/" class="nav-link">
  谷歌规范
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="选择语言" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/alibaba/java-specification.html" class="nav-link router-link-exact-active router-link-active">
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="/en/" class="nav-link">
  English
</a></li></ul></div></div> <a href="https://github.com/programmingStyle/java.programming.style" target="_blank" rel="noopener noreferrer" class="repo-link">
    Java Programming Style
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Java开发手册(泰山版)</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/alibaba/" class="sidebar-link">前言</a></li><li><a href="/alibaba/java-specification.html" class="active sidebar-link">一、 编程规约</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/alibaba/java-specification.html#一-命名风格" class="sidebar-link">(一) 命名风格</a></li><li class="sidebar-sub-header"><a href="/alibaba/java-specification.html#二-常量定义" class="sidebar-link">(二) 常量定义</a></li><li class="sidebar-sub-header"><a href="/alibaba/java-specification.html#三-代码格式" class="sidebar-link">(三) 代码格式</a></li><li class="sidebar-sub-header"><a href="/alibaba/java-specification.html#四-oop-规约" class="sidebar-link">(四) OOP 规约</a></li><li class="sidebar-sub-header"><a href="/alibaba/java-specification.html#五-日期时间" class="sidebar-link">(五) 日期时间</a></li><li class="sidebar-sub-header"><a href="/alibaba/java-specification.html#六-集合处理" class="sidebar-link">(六) 集合处理</a></li><li class="sidebar-sub-header"><a href="/alibaba/java-specification.html#七-并发处理" class="sidebar-link">(七) 并发处理</a></li><li class="sidebar-sub-header"><a href="/alibaba/java-specification.html#八-控制语句" class="sidebar-link">(八) 控制语句</a></li><li class="sidebar-sub-header"><a href="/alibaba/java-specification.html#九-注释规约" class="sidebar-link">(九) 注释规约</a></li><li class="sidebar-sub-header"><a href="/alibaba/java-specification.html#十-其它" class="sidebar-link">(十) 其它</a></li></ul></li><li><a href="/alibaba/exception-log-specification.html" class="sidebar-link">二、异常日志</a></li><li><a href="/alibaba/unit-test-specification.html" class="sidebar-link">三、单元测试</a></li><li><a href="/alibaba/security-specification.html" class="sidebar-link">四、安全规约</a></li><li><a href="/alibaba/mysql-database-specification.html" class="sidebar-link">五、MySQL 数据库</a></li><li><a href="/alibaba/project-struct-specification.html" class="sidebar-link">六、工程结构</a></li><li><a href="/alibaba/design-specification.html" class="sidebar-link">七、设计规约</a></li><li><a href="/alibaba/appendix.html" class="sidebar-link">附录</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="一、-编程规约"><a href="#一、-编程规约" class="header-anchor">#</a> 一、 编程规约</h1> <h2 id="一-命名风格"><a href="#一-命名风格" class="header-anchor">#</a> (一) 命名风格</h2> <ol><li><p>【强制】代码中的命名均不能以<strong>下划线或美元符号</strong>开始，也不能以<strong>下划线或美元符号</strong>结束。</p> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <p><code>_name</code> / <code>__name</code> / <code>$name</code> / <code>name_</code> / <code>name$</code> / <code>name__</code></p></div></li> <li><p>【强制】所有编程相关的命名严禁使用拼音与英文混合的方式，更不允许直接使用中文的方式。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>正确的英文拼写和语法可以让阅读者易于理解，避免歧义。注意，纯拼音命名方式更要避免采用。</p></div> <div class="custom-block tip"><p class="custom-block-title">正例：</p> <p>ali / alibaba / taobao / cainiao/ aliyun/ youku / hangzhou 等国际通用的名称，可视同英文。</p></div> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <p>DaZhePromotion [打折] / getPingfenByName() [评分] / int 某变量 = 3</p></div></li> <li><p>【强制】类名使用 <code>UpperCamelCase</code> 风格，但以下情形例外：DO / BO / DTO / VO / AO /
PO / UID 等。</p> <div class="custom-block tip"><p class="custom-block-title">正例：</p> <p>ForceCode / UserDO / HtmlDTO / XmlService / TcpUdpDeal / TaPromotion</p></div> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <p>forcecode / UserDo / HTMLDto / XMLService / TCPUDPDeal / TAPromotion</p></div></li> <li><p>【强制】方法名、参数名、成员变量、局部变量都统一使用 <code>lowerCamelCase</code> 风格。</p> <div class="custom-block tip"><p class="custom-block-title">正例：</p> <p>localValue / getHttpMessage() / inputUserId</p></div></li> <li><p>【强制】常量命名全部大写，单词间用下划线隔开，力求语义表达完整清楚，不要嫌名字长。</p> <div class="custom-block tip"><p class="custom-block-title">正例：</p> <p>MAX_STOCK_COUNT / CACHE_EXPIRED_TIME</p></div> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <p>MAX_COUNT / EXPIRED_TIME</p></div></li> <li><p>【强制】抽象类命名使用 <code>Abstract</code> 或 <code>Base</code> 开头；异常类命名使用 <code>Exception</code> 结尾；测试类命名以它要测试的类的名称开始，以 <code>Test</code> 结尾。</p></li> <li><p>【强制】类型与中括号紧挨相连来表示数组。</p> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <p>定义整形数组 <code>int[] arrayDemo;</code></p></div> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <p>在 main 参数中，使用 String args[] 来定义。</p></div></li> <li><p>【强制】POJO 类中的任何布尔类型的变量，都不要加 <code>is</code> 前缀，否则部分框架解析会引起序列
化错误。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>在本文 MySQL 规约中的建表约定第一条，表达是与否的值采用 <code>is_xxx</code> 的命名方式，所以，需要在
<code>&lt;resultMap&gt;</code>设置从 <code>is_xxx</code> 到 xxx 的映射关系。</p></div> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <p>定义为基本数据类型 Boolean isDeleted 的属性，它的方法也是 isDeleted()，框架在反向解析的时候，“误以为”对应的属性名称是 deleted，导致属性获取不到，进而抛出异常。</p></div></li> <li><p>【强制】包名统一使用小写，点分隔符之间有且仅有一个自然语义的英语单词。包名统一使用<strong>单数</strong>形式，但是类名如果有复数含义，类名可以使用复数形式。</p> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <p>应用工具类包名为 com.alibaba.ei.kunlun.aap.util、类名为 MessageUtils（此规则参考 spring 的框架结构）</p></div></li> <li><p>【强制】避免在子父类的成员变量之间、或者不同代码块的局部变量之间采用完全相同的命名，使可读性降低。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>子类、父类成员变量名相同，即使是 public 类型的变量也是能够通过编译，而局部变量在同一方法内的不同代码块中同名也是合法的，但是要避免使用。对于非 setter/getter 的参数名称也要避免与成员变量名称相同。</p></div> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConfusingName</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> stock<span class="token punctuation">;</span>
    <span class="token comment">// 非setter/getter的参数名称，不允许与本类成员变量同名</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">String</span> alibaba<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>condition<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">final</span> <span class="token keyword">int</span> money <span class="token operator">=</span> <span class="token number">666</span> <span class="token punctuation">;</span>
            <span class="token comment">// ...</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span> <span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 在同一方法体中，不允许与其它代码块中的money命名相同</span>
            <span class="token keyword">final</span> <span class="token keyword">int</span> money <span class="token operator">=</span> <span class="token number">15978</span> <span class="token punctuation">;</span>
            <span class="token comment">// ...</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Son</span> <span class="token keyword">extends</span> <span class="token class-name">ConfusingName</span> <span class="token punctuation">{</span>
    <span class="token comment">// 不允许与父类的成员变量名称相同</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> stock<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div></li> <li><p>【强制】杜绝完全不规范的缩写，避免望文不知义。</p> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <p>AbstractClass “缩写”命名成 AbsClass；condition “缩写”命名成 condi，此类随意缩写严重降低了代码的可阅读性。</p></div></li> <li><p>【推荐】为了达到代码自解释的目标，任何自定义编程元素在命名时，使用尽量完整的单词组合来表达。</p> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <p>在 JDK 中，对某个对象引用的 volatile 字段进行原子更新的类名为：AtomicReferenceFieldUpdater。</p></div> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <p>常见的方法内变量为 <code>int a;</code> 的定义方式。</p></div></li> <li><p>【推荐】在常量与变量的命名时，表示类型的名词放在词尾，以提升辨识度。</p> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <p>startTime / workQueue / nameList / TERMINATED_THREAD_COUNT</p></div> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <p>startedAt / QueueOfWork / listName / COUNT_TERMINATED_THREAD</p></div></li> <li><p>【推荐】如果模块、接口、类、方法使用了设计模式，在命名时需体现出具体模式。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>将设计模式体现在名字中，有利于阅读者快速理解架构设计理念。</p></div> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderFactory</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LoginProxy</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ResourceObserver</span><span class="token punctuation">;</span>
</code></pre></div></div></li> <li><p>【推荐】接口类中的方法和属性不要加任何修饰符号（public 也不要加），保持代码的简洁性，并加上有效的 Javadoc 注释。尽量不要在接口里定义变量，如果一定要定义变量，确定与接口方法相关，并且是整个应用的基础常量。</p> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <p>接口方法签名 void commit();</p> <p>接口基础常量 String COMPANY = &quot;alibaba&quot;;</p></div> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <p>接口方法定义 public abstract void f();</p></div> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>JDK8 中接口允许有默认实现，那么这个 default 方法，是对所有实现类都有价值的默认实现。</p></div></li> <li><p>接口和实现类的命名有两套规则：</p> <p>1 ）【强制】对于 Service 和 DAO 类，基于 SOA 的理念，暴露出来的服务一定是接口，内部的实现类用 Impl 的后缀与接口区别。</p> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <p>CacheServiceImpl 实现 CacheService 接口。</p></div> <p>2 ）【推荐】如果是形容能力的接口名称，取对应的形容词为接口名（通常是–able 的形容词）。</p> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <p>AbstractTranslator 实现 Translatable 接口。</p></div></li> <li><p>【参考】枚举类名带上 Enum 后缀，枚举成员名称需要全大写，单词间用下划线隔开。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>枚举其实就是特殊的常量类，且构造方法被默认强制是私有。</p></div> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <p>枚举名字为 ProcessStatusEnum 的成员名称：SUCCESS / UNKNOWN_REASON。</p></div></li> <li><p>【参考】各层命名规约：</p> <p>A) Service/DAO 层方法命名规约</p> <div class="language-text extra-class"><pre class="language-text"><code>1 ） 获取单个对象的方法用 get 做前缀。
2 ） 获取多个对象的方法用 list 做前缀，复数结尾，如：listObjects。
3 ） 获取统计值的方法用 count 做前缀。
4 ） 插入的方法用 save/insert 做前缀。
5 ） 删除的方法用 remove/delete 做前缀。
6 ） 修改的方法用 update 做前缀。
</code></pre></div><p>B) 领域模型命名规约</p> <div class="language-text extra-class"><pre class="language-text"><code>1 ） 数据对象：xxxDO，xxx 即为数据表名。
2 ） 数据传输对象：xxxDTO，xxx 为业务领域相关的名称。
3 ） 展示对象：xxxVO，xxx 一般为网页名称。
4 ） POJO 是 DO/DTO/BO/VO 的统称，禁止命名成 xxxPOJO。
</code></pre></div></li></ol> <h2 id="二-常量定义"><a href="#二-常量定义" class="header-anchor">#</a> (二) 常量定义</h2> <ol><li><p>【强制】不允许任何魔法值（即未经预先定义的常量）直接出现在代码中。</p> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//本例中同学A定义了缓存的key，</span>
<span class="token comment">//然后缓存提取的同学B使用了Id#taobao来提取，少了下划线，导致故障。</span>
<span class="token class-name">String</span> key <span class="token operator">=</span> <span class="token string">&quot;Id#taobao_&quot;</span> <span class="token operator">+</span> tradeId<span class="token punctuation">;</span>
cache<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div></li> <li><p>【强制】在<code>long</code>或者<code>Long</code>赋值时，数值后使用大写的 L，不能是小写的 l，小写容易跟数字混淆，造成误解。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>Long a = 2l; 写的是数字的 21 ，还是<code>Long</code>型的 2 。</p></div></li> <li><p>【推荐】不要使用一个常量类维护所有常量，要按常量功能进行归类，分开维护。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>大而全的常量类，杂乱无章，使用查找功能才能定位到修改的常量，不利于理解，也不利于维护。</p></div> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <p>缓存相关常量放在类 CacheConsts 下；</p> <p>系统配置相关常量放在类 ConfigConsts 下。</p></div></li> <li><p>【推荐】常量的复用层次有五层：跨应用共享常量、应用内共享常量、子工程内共享常量、包内共享常量、类内共享常量。</p> <p>1 ） 跨应用共享常量：放置在二方库中，通常是 client.jar 中的 constant 目录下。</p> <p>2 ） 应用内共享常量：放置在一方库中，通常是子模块中的 constant 目录下。</p> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <p>易懂变量也要统一定义成应用内共享常量，两位工程师在两个类中分别定义了“YES”的变量：</p> <p>类 A 中：public static final String YES = &quot;yes&quot;;</p> <p>类 B 中：public static final String YES = &quot;y&quot;;</p> <p>A.YES.equals(B.YES)，预期是 true，但实际返回为 false，导致线上问题。</p></div> <p>3 ） 子工程内部共享常量：即在当前子工程的 constant 目录下。</p> <p>4 ） 包内共享常量：即在当前包下单独的 constant 目录下。</p> <p>5 ） 类内共享常量：直接在类内部<code>private static final</code>定义。</p></li> <li><p>【推荐】如果变量值仅在一个固定范围内变化用<code>enum</code>类型来定义。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>如果存在名称之外的延伸属性应使用<code>enum</code>类型，下面正例中的数字就是延伸信息，表示一年中的第几个季节。</p></div> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">SeasonEnum</span> <span class="token punctuation">{</span>
    <span class="token function">SPRING</span><span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">SUMMER</span><span class="token punctuation">(</span> <span class="token number">2</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">AUTUMN</span><span class="token punctuation">(</span> <span class="token number">3</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">WINTER</span><span class="token punctuation">(</span> <span class="token number">4</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> seq<span class="token punctuation">;</span>
    <span class="token class-name">SeasonEnum</span><span class="token punctuation">(</span><span class="token keyword">int</span> seq<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>seq <span class="token operator">=</span> seq<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getSeq</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> seq<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div></li></ol> <h2 id="三-代码格式"><a href="#三-代码格式" class="header-anchor">#</a> (三) 代码格式</h2> <ol><li><p>【强制】如果是大括号内为空，则简洁地写成{}即可，大括号中间无需换行和空格；如果是非空代码块则：</p> <p>1 ） 左大括号前不换行。</p> <p>2 ） 左大括号后换行。</p> <p>3 ） 右大括号前换行。</p> <p>4 ） 右大括号后还有 else 等代码则不换行；表示终止的右大括号后必须换行。</p></li> <li><p>【强制】左小括号和右边相邻字符之间不出现空格；右小括号和左边相邻字符之间也不出现空格；而左大括号前需要加空格。详见第 5 条下方正例提示。</p> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <p><code>if ( a == b )</code></p></div></li> <li><p>【强制】if/for/while/switch/do 等保留字与括号之间都必须加空格。</p></li> <li><p>【强制】任何二目、三目运算符的左右两边都需要加一个空格。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>包括赋值运算符=、逻辑运算符&amp;&amp;、加减乘除符号等。</p></div></li> <li><p>【强制】采用 4 个空格缩进，禁止使用 tab 字符。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>如果使用 tab 缩进，必须设置 1 个 tab 为 4 个空格。IDEA 设置 tab 为 4 个空格时，请勿勾选<code>Use tab character</code>；而在 eclipse 中，必须勾选<code>insert spaces for tabs</code>。</p></div> <div class="custom-block tip"><p class="custom-block-title">正例: （涉及 1 - 5 点）</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 缩进 4 个空格</span>
    <span class="token class-name">String</span> say <span class="token operator">=</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">;</span>
    <span class="token comment">// 运算符的左右必须有一个空格</span>
    <span class="token keyword">int</span> flag <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span>
    <span class="token comment">// 关键词if与括号之间必须有一个空格，括号内的f与左括号， 0 与右括号不需要空格</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>flag <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>say<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 左大括号前加空格且不换行；左大括号后换行</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>flag <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;world&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 右大括号前换行，右大括号后有else，不用换行</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ok&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 在右大括号后直接结束，则必须换行</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div></li> <li><p>【强制】注释的双斜线与注释内容之间有且仅有一个空格。</p> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 这是示例注释，请注意在双斜线之后有一个空格</span>
<span class="token class-name">String</span> commentString <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div></li> <li><p>【强制】在进行类型强制转换时，右括号与强制转换值之间不需要任何空格隔开。</p> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">long</span> first <span class="token operator">=</span> <span class="token number">1000000000000L</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> second <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>first <span class="token operator">+</span> <span class="token number">2</span> <span class="token punctuation">;</span>
</code></pre></div></div></li> <li><p>【强制】单行字符数限制不超过 120 个，超出需要换行，换行时遵循如下原则：</p> <p>1 ）第二行相对第一行缩进 4 个空格，从第三行开始，不再继续缩进，参考示例。</p> <p>2 ）运算符与下文一起换行。</p> <p>3 ）方法调用的点符号与下文一起换行。</p> <p>4 ）方法调用中的多个参数需要换行时，在逗号后进行。</p> <p>5 ）在括号前不要换行，见反例。</p> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">StringBuilder</span> sb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 超过 120 个字符的情况下，换行缩进 4 个空格，并且方法前的点号一起换行</span>
sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;zi&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;xin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
     <span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;huang&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
     <span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;huang&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
     <span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;huang&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">StringBuilder</span> sb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 超过 120 个字符的情况下，不要在括号前换行</span>
sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;you&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;are&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>append
<span class="token punctuation">(</span><span class="token string">&quot;lucky&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 参数很多的方法调用可能超过 120 个字符，逗号后才是换行处</span>
<span class="token function">method</span><span class="token punctuation">(</span>args1<span class="token punctuation">,</span> args2<span class="token punctuation">,</span> args3<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>
argsX<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div></li> <li><p>【强制】方法参数在定义和传入时，多个参数逗号后边必须加空格。</p> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <p>下例中实参的 args1，后边必须要有一个空格。</p> <p><code>method(args1, args2, args3);</code></p></div></li> <li><p>【强制】IDE 的 text file encoding 设置为 UTF-8; IDE 中文件的换行符使用 Unix 格式，不要使用 Windows 格式。</p></li> <li><p>【推荐】单个方法的总行数不超过 80 行。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>除注释之外的方法签名、左右大括号、方法内代码、空行、回车及任何不可见字符的总行数不超过 80 行。</p></div> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <p>代码逻辑分清红花和绿叶，个性和共性，绿叶逻辑单独出来成为额外方法，使主干代码更加清晰；共性逻辑抽取成为共性方法，便于复用和维护。</p></div></li> <li><p>【推荐】没有必要增加若干空格来使变量的赋值等号与上一行对应位置的等号对齐。</p> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">int</span> one <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">;</span>

<span class="token keyword">long</span> two <span class="token operator">=</span> <span class="token number">2</span> <span class="token class-name">L</span><span class="token punctuation">;</span>

<span class="token keyword">float</span> three <span class="token operator">=</span> <span class="token number">3F</span><span class="token punctuation">;</span>

<span class="token class-name">StringBuilder</span> sb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>增加 sb 这个变量，如果需要对齐，则给 one、two、three 都要增加几个空格，在变量比较多的情况下，是非常累赘的事情。</p></div></li> <li><p>【推荐】不同逻辑、不同语义、不同业务的代码之间插入一个空行分隔开来以提升可读性。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>任何情形，没有必要插入多个空行进行隔开。</p></div></li></ol> <h2 id="四-oop-规约"><a href="#四-oop-规约" class="header-anchor">#</a> (四) OOP 规约</h2> <ol><li><p>【强制】避免通过一个类的对象引用访问此类的静态变量或静态方法，无谓增加编译器解析成本，直接用类名来访问即可。</p></li> <li><p>【强制】所有的覆写方法，必须加 <code>@Override</code> 注解。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p><code>getObject()</code> 与 <code>get0bject()</code> 的问题。一个是字母的 O，一个是数字的 0 ，加 <code>@Override</code> 可以准确判断是否覆盖成功。另外，如果在抽象类中对方法签名进行修改，其实现类会马上编译报错。</p></div></li> <li><p>【强制】相同参数类型，相同业务含义，才可以使用 Java 的可变参数，避免使用 Object。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>可变参数必须放置在参数列表的最后。（提倡同学们尽量不用可变参数编程）</p></div> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token function">listUsers</span><span class="token punctuation">(</span><span class="token class-name">String</span> type<span class="token punctuation">,</span> <span class="token class-name">Long</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> ids<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span>
</code></pre></div></div></li> <li><p>【强制】外部正在调用或者二方库依赖的接口，不允许修改方法签名，避免对接口调用方产生影响。接口过时必须加 <code>@Deprecated</code> 注解，并清晰地说明采用的新接口或者新服务是什么。</p></li> <li><p>【强制】不能使用过时的类或方法。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p><code>java.net.URLDecoder</code> 中的方法 <code>decode(String encodeStr)</code> 这个方法已经过时，应该使用双参数 <code>decode(String source, String encode)</code>。</p> <p>接口提供方既然明确是过时接口，那么有义务同时提供新的接口；</p> <p>作为调用方来说，有义务去考证过时方法的新实现是什么。</p></div></li> <li><p>【强制】Object 的 <code>equals</code> 方法容易抛空指针异常，应使用常量或确定有值的对象来调用 <code>equals</code>。</p> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <p><code>&quot;test&quot;.equals(object);</code></p></div> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <p><code>object.equals(&quot;test&quot;);</code></p></div> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>推荐使用 <code>java.util.Objects#equals</code>（JDK7 引入的工具类）。</p></div></li> <li><p>【强制】所有整型包装类对象之间<strong>值的比较</strong>，全部使用 <code>equals</code> 方法比较。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>对于 <code>Integer var =?</code> 在 <strong>-128 至 127</strong> 之间的赋值，<code>Integer</code> 对象是在 <code>IntegerCache.cache</code> 产生，<strong>会复用</strong>已有对象，这个区间内的 <code>Integer</code> 值可以直接使用<code>==</code>进行判断，但是这个<strong>区间之外的所有数据</strong>，都会在堆上产生，并<strong>不会复用</strong>已有对象，这是一个大坑，推荐使用<code>equals</code> 方法进行判断。</p></div></li> <li><p>【强制】任何货币金额，均以最小货币单位且整型类型来进行存储。</p></li> <li><p>【强制】浮点数之间的等值判断，<strong>基本数据类型</strong>不能用<code>==</code>来比较，<strong>包装数据类型</strong>不能用 <code>equals</code> 来判断。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>浮点数采用“尾数+阶码”的编码方式，类似于科学计数法的“有效数字+指数”的表示方式。二进制无法精确表示大部分的十进制小数，具体原理参考《码出高效》。</p></div> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">float</span> a <span class="token operator">=</span> <span class="token number">1.0f</span> <span class="token operator">-</span> <span class="token number">0.9f</span><span class="token punctuation">;</span>
<span class="token keyword">float</span> b <span class="token operator">=</span> <span class="token number">0.9f</span> <span class="token operator">-</span> <span class="token number">0.8f</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">==</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token comment">// 预期进入此代码快，执行其它业务逻辑</span>
     <span class="token comment">// 但事实上 a==b 的结果为 false</span>
<span class="token punctuation">}</span>
<span class="token class-name">Float</span> x <span class="token operator">=</span> <span class="token class-name">Float</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Float</span> y <span class="token operator">=</span> <span class="token class-name">Float</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token comment">// 预期进入此代码快，执行其它业务逻辑</span>
     <span class="token comment">// 但事实上 equals 的结果为 false</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <p>(1) 指定一个误差范围，两个浮点数的差值在此范围之内，则认为是相等的。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">float</span> a <span class="token operator">=</span> <span class="token number">1.0f</span> <span class="token operator">-</span> <span class="token number">0.9f</span><span class="token punctuation">;</span>
<span class="token keyword">float</span> b <span class="token operator">=</span> <span class="token number">0.9f</span> <span class="token operator">-</span> <span class="token number">0.8f</span><span class="token punctuation">;</span>
<span class="token keyword">float</span> diff <span class="token operator">=</span> <span class="token number">1e-6f</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>a <span class="token operator">-</span> b<span class="token punctuation">)</span> <span class="token operator">&lt;</span> diff<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;true&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>(2) 使用 BigDecimal 来定义值，再进行浮点数的运算操作。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">BigDecimal</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;1.0&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">BigDecimal</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;0.9&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">BigDecimal</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;0.8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">BigDecimal</span> x <span class="token operator">=</span> a<span class="token punctuation">.</span><span class="token function">subtract</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">BigDecimal</span> y <span class="token operator">=</span> b<span class="token punctuation">.</span><span class="token function">subtract</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;true&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div></li> <li><p>【强制】定义数据对象 DO 类时，属性类型要与数据库字段类型相匹配。</p> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <p>数据库字段的 <code>bigint</code> 必须与类属性的 <code>Long</code> 类型相对应。</p></div> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <p>某个案例的数据库表 <code>id</code> 字段定义类型 <code>bigint unsigned</code>，实际类对象属性为 <code>Integer</code>，随着 <code>id</code> 越来越大，超过 <code>Integer</code> 的表示范围而溢出成为负数。</p></div></li> <li><p>【强制】禁止使用构造方法 <code>BigDecimal(double)</code> 的方式把 <code>double</code> 值转化为 <code>BigDecimal</code> 对象。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p><code>BigDecimal(double)</code> 存在精度损失风险，在精确计算或值比较的场景中可能会导致业务逻辑异常。</p> <p>如：<code>BigDecimal g = new BigDecimal(0.1f);</code> 实际的存储值为：0.</p></div> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <p>优先推荐入参为 <code>String</code> 的构造方法，或使用 <code>BigDecimal</code> 的 <code>valueOf</code> 方法，此方法内部其实执行了 <code>Double</code> 的 <code>toString</code>，而 <code>Double</code> 的 <code>toString</code> 按 <code>double</code> 的实际能表达的精度对尾数进行了截断。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">BigDecimal</span> recommend1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;0.1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">BigDecimal</span> recommend2 <span class="token operator">=</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div></li> <li><p>关于基本数据类型与包装数据类型的使用标准如下：</p> <p>1 ） 【强制】所有的 <code>POJO</code> 类属性必须使用<strong>包装数据类型</strong>。</p> <p>2 ） 【强制】<code>RPC</code> 方法的返回值和参数必须使用<strong>包装数据类型</strong>。</p> <p>3 ） 【推荐】所有的局部变量使用<strong>基本数据类型</strong>。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p><code>POJO</code> 类属性没有初值是提醒使用者在需要使用时，必须自己显式地进行赋值，任何 <code>NPE</code> 问题，或者入库检查，都由使用者来保证。</p></div> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <p>数据库的查询结果可能是 <code>null</code>，因为自动拆箱，用基本数据类型接收有 <code>NPE</code> 风险。</p></div> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <p>某业务的交易报表上显示成交总额涨跌情况，即正负 x%，x 为基本数据类型，调用的 RPC 服务，调用不成功时，返回的是默认值，页面显示为 0%，这是不合理的，应该显示成中划线<code>-</code>。所以包装数据类型的 null 值，能够表示额外的信息，如：远程调用失败，异常退出。</p></div></li> <li><p>【强制】定义 DO/DTO/VO 等 POJO 类时，不要设定任何属性默认值。</p> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <p>POJO 类的 <code>createTime</code> 默认值为 <code>new Date()</code>，但是这个属性在数据提取时并没有置入具体值，在更新其它字段时又附带更新了此字段，导致创建时间被修改成当前时间。</p></div></li> <li><p>【强制】序列化类新增属性时，请<strong>不要修改</strong> <code>serialVersionUID</code> 字段，避免反序列失败；如果完全不兼容升级，避免反序列化混乱，那么请修改 <code>serialVersionUID</code> 值。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>注意 <code>serialVersionUID</code> 不一致会抛出序列化运行时异常。</p></div></li> <li><p>【强制】构造方法里面禁止加入任何业务逻辑，如果有初始化逻辑，请放在 <code>init</code> 方法中。</p></li> <li><p>【强制】POJO 类必须写 <code>toString</code> 方法。使用 IDE 中的工具：<code>source&gt; generate toString</code> 时，如果继承了另一个 POJO 类，注意在前面加一下 <code>super.toString</code>。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>在方法执行抛出异常时，可以直接调用 POJO 的 <code>toString()</code>方法打印其属性值，便于排查问题。</p></div></li> <li><p>【强制】禁止在 POJO 类中，同时存在对应属性 <code>xxx</code> 的 <code>isXxx()</code>和 <code>getXxx()</code>方法。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>框架在调用属性 <code>xxx</code> 的提取方法时，并不能确定哪个方法一定是被优先调用到，神坑之一。</p></div></li> <li><p>【推荐】使用索引访问用 <code>String</code> 的 <code>split</code> 方法得到的数组时，需做最后一个分隔符后有无内容的检查，否则会有抛 <code>IndexOutOfBoundsException</code> 的风险。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">String</span> str <span class="token operator">=</span> <span class="token string">&quot;a,b,c,,&quot;</span><span class="token punctuation">;</span>
<span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ary <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 预期大于 3 ，结果是 3</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>ary<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div></li> <li><p>【推荐】当一个类有多个构造方法，或者多个同名方法，这些方法应该按顺序放置在一起，便于阅读，此条规则优先于下一条。</p></li> <li><p>【推荐】 类内方法定义的顺序依次是：<code>公有方法或保护方法</code> &gt; <code>私有方法</code> &gt; <code>getter/setter</code> 方法。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>公有方法是类的调用者和维护者最关心的方法，首屏展示最好；保护方法虽然只是子类关心，也可能是“模板设计模式”下的核心方法；而私有方法外部一般不需要特别关心，是一个黑盒实现；因为承载的信息价值较低，所有 Service 和 DAO 的 <code>getter/setter</code> 方法放在类体最后。</p></div></li> <li><p>【推荐】<code>setter</code> 方法中，参数名称与类成员变量名称一致，<code>this.成员名 = 参数名</code>。在 <code>getter/setter</code> 方法中，不要增加业务逻辑，增加排查问题的难度。</p> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">Integer</span> getData <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>condition<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data <span class="token operator">+</span> <span class="token number">100</span> <span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data <span class="token operator">-</span> <span class="token number">100</span> <span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div></li> <li><p>【推荐】循环体内，字符串的连接方式，使用 <code>StringBuilder</code> 的 <code>append</code> 方法进行扩展。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>下例中，反编译出的字节码文件显示每次循环都会 new 出一个 StringBuilder 对象，然后进行 append 操作，最后通过 toString 方法返回 String 对象,造成内存资源浪费。</p></div> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">String</span> str <span class="token operator">=</span> <span class="token string">&quot;start&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span> <span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    str <span class="token operator">=</span> str <span class="token operator">+</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div></li> <li><p>【推荐】<code>final</code> 可以声明类、成员变量、方法、以及本地变量，下列情况使用 final 关键字：</p> <p>1 ） 不允许被继承的类，如：<code>String</code> 类。</p> <p>2 ） 不允许修改引用的域对象，如：POJO 类的域变量。</p> <p>3 ） 不允许被覆写的方法，如：POJO 类的 <code>setter</code> 方法。</p> <p>4 ） 不允许运行过程中重新赋值的局部变量。</p> <p>5 ） 避免上下文重复使用一个变量，使用 <code>final</code> 可以强制重新定义一个变量，方便更好地进行重构。</p></li> <li><p>【推荐】慎用 Object 的 <code>clone</code> 方法来拷贝对象。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>对象 <code>clone</code> 方法默认是浅拷贝，若想实现深拷贝需覆写 <code>clone</code> 方法实现域对象的深度遍历式拷贝。</p></div></li> <li><p>【推荐】类成员与方法访问控制从严：</p> <p>1 ） 如果不允许外部直接通过 new 来创建对象，那么构造方法必须是 <code>private。</code></p> <p>2 ） 工具类不允许有 <code>public</code> 或 <code>default</code> 构造方法。</p> <p>3 ） 类非 <code>static</code> 成员变量并且与子类共享，必须是 <code>protected</code>。</p> <p>4 ） 类非 <code>static</code> 成员变量并且仅在本类使用，必须是 <code>private</code>。</p> <p>5 ） 类 <code>static</code> 成员变量如果仅在本类使用，必须是 <code>private</code>。</p> <p>6 ） 若是 <code>static</code> 成员变量，考虑是否为 <code>final</code>。</p> <p>7 ） 类成员方法只供类内部调用，必须是 <code>private</code>。</p> <p>8 ） 类成员方法只对继承类公开，那么限制为 <code>protected</code>。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>任何类、方法、参数、变量，严控访问范围。过于宽泛的访问范围，不利于模块解耦。</p> <p>思考：如果是一个 <code>private</code> 的方法，想删除就删除，可是一个 <code>public</code> 的 <code>service</code> 成员方法或成员变量，删除一下，不得手心冒点汗吗？</p> <p>变量像自己的小孩，尽量在自己的视线内，变量作用域太大，无限制的到处跑，那么你会担心的。</p></div></li></ol> <h2 id="五-日期时间"><a href="#五-日期时间" class="header-anchor">#</a> (五) 日期时间</h2> <ol><li><p>【强制】日期格式化时，传入 <code>pattern</code> 中表示年份统一使用小写的 <code>y</code>。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>日期格式化时，<code>yyyy</code> 表示<strong>当天所在的年</strong>，而大写的 <code>YYYY</code> 代表是 week in which year（JDK7 之后引入的概念），意思是<strong>当天所在的周属于的年份</strong>，一周从周日开始，周六结束，<strong>只要本周跨年，返回的 YYYY 就是下一年</strong>。</p></div> <div class="custom-block tip"><p class="custom-block-title">正例:表示日期和时间的格式如下所示：</p> <p><code>new SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;)</code></p></div></li> <li><p>【强制】在日期格式中分清楚大写的 <code>M</code> 和小写的 <code>m</code>，大写的 <code>H</code> 和小写的 <code>h</code> 分别指代的意义。</p> <div class="custom-block warning"><p class="custom-block-title">说明：日期格式中的这两对字母表意如下：</p> <p>1 ） 表示月份是大写的 <code>M</code>；</p> <p>2 ） 表示分钟则是小写的 <code>m</code>；</p> <p>3 ） 24 小时制的是大写的 <code>H</code>；</p> <p>4 ） 12 小时制的则是小写的 <code>h</code>。</p></div></li> <li><p>【强制】获取当前毫秒数：<code>System.currentTimeMillis()</code>; 而<strong>不是</strong> <code>new Date().getTime()</code>。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>如果想获取更加精确的纳秒级时间值，使用 <code>System.nanoTime</code> 的方式。在 JDK8 中，针对统计时间等场景，推荐使用 <code>Instant</code> 类。</p></div></li> <li><p>【强制】不允许在程序任何地方中使用：</p> <p>1）<code>java.sql.Date</code></p> <p>2）<code>java.sql.Time</code></p> <p>3）<code>java.sql.Timestamp</code></p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>第 1 个不记录时间，<code>getHours()</code>抛出异常；</p> <p>第 2 个不记录日期，<code>getYear()</code>抛出异常；</p> <p>第 3 个在构造方法 <code>super((time/1000)\*1000)</code>，<code>fastTime</code> 和 <code>nanos</code>分开存储秒和纳秒信息。</p></div> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <p><code>java.util.Date.after(Date)</code>进行时间比较时，当入参是 <code>java.sql.Timestamp</code> 时，会触发 JDKBUG(JDK9 已修复)，可能导致比较时的意外结果。</p></div></li> <li><p>【强制】不要在程序中写死一年为 365 天，避免在公历闰年时出现日期转换错误或程序逻辑错误。</p> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 获取今年的天数</span>
<span class="token keyword">int</span> daysOfThisYear <span class="token operator">=</span> <span class="token class-name">LocalDate</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">lengthOfYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 获取指定某年的天数</span>
<span class="token class-name">LocalDate</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span> <span class="token number">2011</span> <span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">lengthOfYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 第一种情况：在闰年 366 天时，出现数组越界异常</span>
<span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> dayArray <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span> <span class="token number">365</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// 第二种情况：一年有效期的会员制，今年 1 月 26 日注册，硬编码 365 返回的是 1 月 25 日</span>
<span class="token class-name">Calendar</span> calendar <span class="token operator">=</span> <span class="token class-name">Calendar</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
calendar<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span> <span class="token number">2020</span> <span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation">,</span> <span class="token number">26</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
calendar<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Calendar</span><span class="token punctuation">.</span>DATE<span class="token punctuation">,</span> <span class="token number">365</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div></li> <li><p>【推荐】避免公历闰年 2 月问题。闰年的 2 月份有 29 天，一年后的那一天不可能是 2 月 29 日。</p></li> <li><p>【推荐】使用枚举值来指代月份。如果使用数字，注意 <code>Date</code>，<code>Calendar</code> 等日期相关类的月份 <code>month</code> 取值在 <code>0 - 11</code> 之间。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>参考 JDK 原生注释，Month value is 0-based. e.g., 0 for January.</p></div> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <p><code>Calendar.JANUARY</code>，<code>Calendar.FEBRUARY</code>，<code>Calendar.MARCH</code> 等来指代相应月份来进行传参或比较。</p></div></li></ol> <h2 id="六-集合处理"><a href="#六-集合处理" class="header-anchor">#</a> (六) 集合处理</h2> <ol><li><p>【强制】关于 <code>hashCode</code> 和 <code>equals</code> 的处理，遵循如下规则：</p> <p>1 ） <strong>只要重写</strong> <code>equals</code>，<strong>就必须重写</strong> <code>hashCode</code>。</p> <p>2 ） 因为 <code>Set</code> 存储的是不重复的对象，依据 <code>hashCode</code> 和 <code>equals</code> 进行判断，所以 <code>Set</code> 存储的对象必须重写这两个方法。</p> <p>3 ） 如果自定义对象作为 <code>Map</code> 的键，那么必须覆写 <code>hashCode</code> 和 <code>equals</code>。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p><code>String</code> 因为重写了 <code>hashCode</code> 和 <code>equals</code> 方法，所以我们可以愉快地使用 <code>String</code> 对象作为 <code>key</code> 来使用。</p></div></li> <li><p>【强制】判断所有集合内部的元素是否为空，使用 <code>isEmpty()</code>方法，而<strong>不是</strong> <code>size()==0</code> 的方式。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>前者的时间复杂度为 <code>O(1)</code>，而且可读性更好。</p></div> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;no element in this map.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div></li> <li><p>【强制】在使用 <code>java.util.stream.Collectors</code> 类的 <code>toMap()</code>方法转为 Map 集合时，一定要使用含有参数类型为 <code>BinaryOperator</code>，参数名为 <code>mergeFunction</code> 的方法，否则当出现相同 <code>key</code> 值时会抛出 <code>IllegalStateException</code> 异常。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>参数 <code>mergeFunction</code> 的作用是当出现 <code>key</code> 重复时，自定义对 <code>value</code> 的处理策略。</p></div> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Pair</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Double</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> pairArrayList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span> <span class="token number">3</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
pairArrayList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Pair</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token string">&quot;version&quot;</span><span class="token punctuation">,</span> <span class="token number">6.19</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
pairArrayList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Pair</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token string">&quot;version&quot;</span><span class="token punctuation">,</span> <span class="token number">10.24</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
pairArrayList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Pair</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token string">&quot;version&quot;</span><span class="token punctuation">,</span> <span class="token number">13.14</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Double</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> pairArrayList<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span>
    <span class="token comment">// 生成的map集合中只有一个键值对：{version=13.14}</span>
    <span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toMap</span><span class="token punctuation">(</span><span class="token class-name">Pair</span><span class="token operator">::</span><span class="token function">getKey</span><span class="token punctuation">,</span> <span class="token class-name">Pair</span><span class="token operator">::</span><span class="token function">getValue</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>v1<span class="token punctuation">,</span> v2<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token operator">&gt;</span> v2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div></div> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> departments <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span><span class="token string">&quot;iERP&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;iERP&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;EIBU&quot;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 抛出IllegalStateException异常</span>
<span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span>departments<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toMap</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token operator">::</span><span class="token function">hashCode</span><span class="token punctuation">,</span> str <span class="token operator">-&gt;</span> str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div></li> <li><p>【强制】在使用 <code>java.util.stream.Collectors</code> 类的 <code>toMap()</code>方法转为 Map 集合时，一定要注意当 <code>value</code> 为 <code>null</code> 时会抛 <code>NPE</code> 异常。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>在 java.util.HashMap 的 merge 方法里会进行如下的判断：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> remappingFunction <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NullPointerException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Pair</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Double</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> pairArrayList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span> <span class="token number">2</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
pairArrayList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Pair</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token string">&quot;version1&quot;</span><span class="token punctuation">,</span> <span class="token number">4.22</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
pairArrayList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Pair</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token string">&quot;version2&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Double</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> pairArrayList<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span>
    <span class="token comment">// 抛出NullPointerException异常</span>
    <span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toMap</span><span class="token punctuation">(</span><span class="token class-name">Pair</span><span class="token operator">::</span><span class="token function">getKey</span><span class="token punctuation">,</span> <span class="token class-name">Pair</span><span class="token operator">::</span><span class="token function">getValue</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>v1<span class="token punctuation">,</span> v2<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token operator">&gt;</span> v2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div></li> <li><p>【强制】ArrayList 的 <code>subList</code> 结果不可强转成 ArrayList，否则会抛出 <code>ClassCastException</code> 异常：<code>java.util.RandomAccessSubList cannot be cast to java.util.ArrayList</code>。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p><code>subList</code> 返回的是 ArrayList 的<strong>内部类 SubList</strong>，并不是 ArrayList 而是 ArrayList 的一个视图，对于 <code>SubList</code> 子列表的所有操作最终会反映到原列表上。</p></div></li> <li><p>【强制】使用 Map 的方法 <code>keySet()/values()/entrySet()</code>返回集合对象时，不可以对其进行添加元素操作，否则会抛出 <code>UnsupportedOperationException</code> 异常。</p></li> <li><p>【强制】Collections 类返回的对象，如：<code>emptyList()</code>/<code>singletonList()</code>等都是 <code>immutable list</code>，不可对其进行添加或者删除元素的操作。</p> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <p>如果查询无结果，返回 <code>Collections.emptyList()</code>空集合对象，调用方一旦进行了添加元素的操作，就会触发 <code>UnsupportedOperationException</code> 异常。</p></div></li> <li><p>【强制】在 <code>subList</code> 场景中，高度注意对父集合元素的增加或删除，均会导致子列表的遍历、增加、删除产生 <code>ConcurrentModificationException</code> 异常。</p></li> <li><p>【强制】使用集合转数组的方法，必须使用集合的 <code>toArray(T[] array)</code>，传入的是类型完全一致、长度为 <code>0</code> 的空数组。</p> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <p>直接使用 <code>toArray</code> 无参方法存在问题，此方法返回值只能是 <code>Object[]</code>类，若强转其它类型数组将出现 <code>ClassCastException</code> 错误。</p></div> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span> <span class="token number">2</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;guan&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;bao&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> array <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>使用 <code>toArray</code> 带参方法，数组空间大小的 <code>length</code>，</p> <p>1 ） 等于 <code>0</code> ，动态创建与 <code>size</code> 相同的数组，性能最好。</p> <p>2 ） 大于 <code>0</code> 但小于 <code>size</code>，重新创建大小等于 <code>size</code> 的数组，增加 <code>GC</code> 负担。</p> <p>3 ） 等于 <code>size</code>，在高并发情况下，数组创建完成之后，<code>size</code> 正在变大的情况下，负面影响与 2 相同。</p> <p>4 ） 大于 <code>size</code>，空间浪费，且在 <code>size</code> 处插入 <code>null</code> 值，存在 <code>NPE</code> 隐患。</p></div></li> <li><p>【强制】在使用 Collection 接口任何实现类的 <code>addAll()</code>方法时，都要对输入的集合参数进行 <code>NPE</code> 判断。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>在 <code>ArrayList#addAll</code> 方法的第一行代码即 <code>Object[] a = c.toArray();</code></p> <p>其中 <code>c</code> 为输入集合参数，如果为 <code>null</code>，则直接抛出异常。</p></div></li> <li><p>【强制】使用工具类 <code>Arrays.asList()</code> 把数组转换成集合时，不能使用其修改集合相关的方法，它的 <code>add/remove/clear</code> 方法会抛出 <code>UnsupportedOperationException</code> 异常。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>asList 的返回对象是一个 Arrays 内部类，并没有实现集合的修改方法。Arrays.asList 体现的是适配器模式，只是转换接口，后台的数据仍是数组。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;yang&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hao&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">List</span> list <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>第一种情况：<code>list.add(&quot;yangguanbao&quot;);</code> 运行时异常。</p> <p>第二种情况：<code>str[0] = &quot;changed&quot;;</code> 也会随之修改，反之亦然。</p></div></li> <li><p>【强制】泛型通配符 <code>&lt;? extends T&gt;</code> 来接收返回的数据，此写法的泛型集合不能使用 <code>add</code> 方法，而<code>&lt;? super T&gt;</code>不能使用 <code>get</code> 方法，两者在接口调用赋值的场景中容易出错。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>扩展说一下 PECS(Producer Extends Consumer Super)原则：</p> <p>第一、频繁往外读取内容的，适合用 <code>&lt;? extends T&gt;</code>。</p> <p>第二、经常往里插入的，适合用 <code>&lt;? super T&gt;</code>。</p></div></li> <li><p>【强制】在无泛型限制定义的集合赋值给泛型限制的集合时，在使用集合元素时，需要进行 <code>instanceof</code> 判断，避免抛出 <code>ClassCastException</code> 异常。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>毕竟泛型是在 JDK5 后才出现，考虑到向前兼容，编译器是允许非泛型集合与泛型集合互相赋值。</p></div> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> generics <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token class-name">List</span> notGenerics <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span> <span class="token number">10</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
notGenerics<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
notGenerics<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Integer</span><span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
generics <span class="token operator">=</span> notGenerics<span class="token punctuation">;</span>
<span class="token comment">// 此处抛出ClassCastException异常</span>
<span class="token class-name">String</span> string <span class="token operator">=</span> generics<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span> <span class="token number">0</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div></li> <li><p>【强制】不要在 <code>foreach</code> 循环里进行元素的 <code>remove/add</code> <code>操作。remove</code> 元素请使用 <code>Iterator</code> 方式，如果<strong>并发</strong>操作，需要对 Iterator 对象<strong>加锁</strong>。</p> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> iterator <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span>iterator<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> item <span class="token operator">=</span> iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>删除元素的条件<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        iterator<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> item <span class="token operator">:</span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        list<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>以上代码的执行结果肯定会出乎大家的意料，那么试一下把“1”换成“2”，会是同样的结果吗？</p></div></li> <li><p>【强制】在 JDK 7 版本及以上，<code>Comparator</code> 实现类要满足如下三个条件，不然 <code>Arrays.sort</code>，<code>Collections.sort</code> 会抛 <code>IllegalArgumentException</code> 异常。</p> <div class="custom-block warning"><p class="custom-block-title">说明：三个条件如下</p> <p>1 ） <code>x</code>，<code>y</code> 的比较结果和 <code>y</code>，<code>x</code> 的比较结果相反。</p> <p>2 ） <code>x&gt;y</code>，<code>y&gt;z</code>，则 <code>x&gt;z</code>。</p> <p>3 ） <code>x=y</code>，则 <code>x</code>，<code>z</code> 比较结果和 <code>y</code>，<code>z</code> 比较结果相同。</p></div> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <p>下例中没有处理相等的情况，交换两个对象判断结果并不互反，不符合第一个条件，在实际使用中可能会出现异常。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">new</span> <span class="token class-name">Comparator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Student</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token annotation punctuation">@Override</span>
   <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">compare</span><span class="token punctuation">(</span><span class="token class-name">Student</span> o1<span class="token punctuation">,</span> <span class="token class-name">Student</span> o2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> o1<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> o2<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></div></li> <li><p>【推荐】集合泛型定义时，在 JDK7 及以上，使用 <code>diamond</code> 语法或全省略。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>菱形泛型，即 <code>diamond</code>，直接使用<code>&lt;&gt;</code>来指代前边已经指定的类型。</p></div> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// diamond方式，即&lt;&gt;</span>
<span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> userCache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span> <span class="token number">16</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 全省略方式</span>
<span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> users <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span> <span class="token number">10</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div></li> <li><p>【推荐】集合初始化时，指定集合初始值大小。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>HashMap 使用 <code>HashMap(int initialCapacity)</code> 初始化，如果暂时无法确定集合大小，那么指定默认值<code>（ 16 ）</code>即可。</p></div> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <p>initialCapacity = (需要存储的元素个数 / 负载因子) + 1。</p> <p>注意负载因子（即 loader factor）默认为 <code>0.75</code>，如果暂时无法确定初始值大小，请设置为 <code>16</code> （即默认值）。</p></div> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <p>HashMap 需要放置 1024 个元素，由于没有设置容量初始大小，随着元素不断增加，容量 7 次被迫扩大，resize 需要重建 hash 表。</p> <p>当放置的集合元素个数达千万级别时，不断扩容会严重影响性能。</p></div></li> <li><p>【推荐】使用 <code>entrySet</code> 遍历 <code>Map</code> 类集合 <code>KV</code>，而不是 <code>keySet</code> 方式进行遍历。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p><code>keySet</code> 其实是遍历了 <strong>2 次</strong>，一次是转为 <code>Iterator</code> 对象，另一次是从 <code>hashMap</code> 中取出 <code>key</code> 所对应的 <code>value</code>。</p> <p>而 <code>entrySet</code> 只是遍历了<strong>一次</strong>就把 <code>key</code> 和 <code>value</code> 都放到了 <code>entry</code> 中，效率更高。</p> <p>如果是 JDK8，使用 <code>Map.forEach</code> 方法。</p></div> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <p><code>values()</code>返回的是 <code>V</code> 值集合，是一个 <code>list</code> 集合对象；</p> <p><code>keySet()</code>返回的是 <code>K</code> 值集合，是一个 <code>Set</code> 集合对象；</p> <p><code>entrySet()</code>返回的是 <code>K-V</code>值组合集合。</p></div></li> <li><p>【推荐】高度注意 <code>Map</code> 类集合 <code>K/V</code> 能不能存储 <code>null</code> 值的情况，如下表格：</p> <table><thead><tr><th style="text-align:center;">集合类</th> <th style="text-align:center;">Key</th> <th style="text-align:center;">Value</th> <th style="text-align:center;">Super</th> <th style="text-align:center;">说明</th></tr></thead> <tbody><tr><td style="text-align:center;">Hashtable</td> <td style="text-align:center;">不允许为 null</td> <td style="text-align:center;">不允许为 null</td> <td style="text-align:center;">Dictionary</td> <td style="text-align:center;">线程安全</td></tr> <tr><td style="text-align:center;">ConcurrentHashMap</td> <td style="text-align:center;">不允许为 null</td> <td style="text-align:center;">不允许为 null</td> <td style="text-align:center;">AbstractMap</td> <td style="text-align:center;">锁分段技术（JDK8:CAS）</td></tr> <tr><td style="text-align:center;">TreeMap</td> <td style="text-align:center;">不允许为 null</td> <td style="text-align:center;">允许为 null</td> <td style="text-align:center;">AbstractMap</td> <td style="text-align:center;">线程不安全</td></tr> <tr><td style="text-align:center;">HashMap</td> <td style="text-align:center;">允许为 null</td> <td style="text-align:center;">允许为 null</td> <td style="text-align:center;">AbstractMap</td> <td style="text-align:center;">线程不安全</td></tr></tbody></table> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <p>由于 <code>HashMap</code> 的干扰，很多人认为 <code>ConcurrentHashMap</code> 是可以置入 <code>null</code> 值，而事实上，存储 <code>null</code> 值时会抛出 <code>NPE</code> 异常。</p></div></li> <li><p>【参考】合理利用好集合的有序性(sort)和稳定性(order)，避免集合的无序性(unsort)和不稳定性(unorder)带来的负面影响。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>有序性是指遍历的结果是按某种比较规则依次排列的。稳定性指集合每次遍历的元素次序是一定的。如：</p> <p><code>ArrayList</code> 是 <code>order</code>/<code>unsort</code>；</p> <p><code>HashMap</code> 是 <code>unorder</code>/<code>unsort</code>；</p> <p><code>TreeSet</code> 是 <code>order</code>/<code>sort</code>。</p></div></li> <li><p>【参考】利用 <code>Set</code> 元素唯一的特性，可以快速对一个集合进行去重操作，避免使用 <code>List</code> 的 <code>contains()</code> 进行遍历去重或者判断包含操作。</p></li></ol> <h2 id="七-并发处理"><a href="#七-并发处理" class="header-anchor">#</a> (七) 并发处理</h2> <ol><li><p>【强制】获取单例对象需要保证线程安全，其中的方法也要保证线程安全。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>资源驱动类、工具类、单例工厂类都需要注意。</p></div></li> <li><p>【强制】创建线程或线程池时请指定有意义的线程名称，方便出错时回溯。</p> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <p>自定义线程工厂，并且根据外部特征进行分组，比如，来自同一机房的调用，把机房编号赋值给 <code>whatFeaturOfGroup</code></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserThreadFactory</span> <span class="token keyword">implements</span> <span class="token class-name">ThreadFactory</span> <span class="token punctuation">{</span>
     <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> namePrefix<span class="token punctuation">;</span>
     <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">AtomicInteger</span> nextId <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AtomicInteger</span><span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token comment">// 定义线程组名称，在jstack问题排查时，非常有帮助</span>
     <span class="token class-name">UserThreadFactory</span><span class="token punctuation">(</span><span class="token class-name">String</span> whatFeaturOfGroup<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         namePrefix <span class="token operator">=</span> <span class="token string">&quot;From UserThreadFactory's &quot;</span> <span class="token operator">+</span> whatFeaturOfGroup <span class="token operator">+</span> <span class="token string">&quot;-Worker-&quot;</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
     <span class="token annotation punctuation">@Override</span>
     <span class="token keyword">public</span> <span class="token class-name">Thread</span> <span class="token function">newThread</span><span class="token punctuation">(</span><span class="token class-name">Runnable</span> task<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token class-name">String</span> name <span class="token operator">=</span> namePrefix <span class="token operator">+</span> nextId<span class="token punctuation">.</span><span class="token function">getAndIncrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token class-name">Thread</span> thread <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> task<span class="token punctuation">,</span> name<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>thread<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">return</span> thread<span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div></li> <li><p>【强制】线程资源必须通过线程池提供，不允许在应用中自行显式创建线程。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>线程池的好处是减少在创建和销毁线程上所消耗的时间以及系统资源的开销，解决资源不足的问题。</p> <p>如果不使用线程池，有可能造成系统创建大量同类线程而导致消耗完内存或者“过度切换”的问题。</p></div></li> <li><p>【强制】线程池不允许使用 <code>Executors</code> 去创建，而是通过 <code>ThreadPoolExecutor</code> 的方式，这样的处理方式让写的同学更加明确线程池的运行规则，规避资源耗尽的风险。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>Executors 返回的线程池对象的弊端如下：</p> <p>1 ） <code>FixedThreadPool</code> 和 <code>SingleThreadPool</code>：允许的请求队列长度为 <code>Integer.MAX_VALUE</code>，可能会堆积大量的请求，从而导致 <code>OOM</code>。</p> <p>2 ） <code>CachedThreadPool</code>：允许的创建线程数量为 <code>Integer.MAX_VALUE</code>，可能会创建大量的线程，从而导致 <code>OOM</code>。</p></div></li> <li><p>【强制】<code>SimpleDateFormat</code> 是线程不安全的类，一般不要定义为 <code>static</code> 变量，如果定义为 <code>static</code>，必须加锁，或者使用 <code>DateUtils</code> 工具类。</p> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <p>注意线程安全，使用 DateUtils。亦推荐如下处理：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">ThreadLocal</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DateFormat</span><span class="token punctuation">&gt;</span></span> df <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadLocal</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DateFormat</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token annotation punctuation">@Override</span>
     <span class="token keyword">protected</span> <span class="token class-name">DateFormat</span> <span class="token function">initialValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">&quot;yyyy-MM-dd&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></div> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>如果是 JDK8 的应用，可以使用 <code>Instant</code> 代替 <code>Date</code>，<code>LocalDateTime</code> 代替 <code>Calendar</code>，<code>DateTimeFormatter</code> 代替 <code>SimpleDateFormat</code>，官方给出的解释：<code>simple beautiful strong immutablethread-safe</code>。</p></div></li> <li><p>【强制】必须回收自定义的 <code>ThreadLocal</code> 变量，尤其在线程池场景下，线程经常会被复用，如果不清理自定义的 <code>ThreadLocal</code> 变量，可能会影响后续业务逻辑和造成内存泄露等问题。尽量在代理中使用 <code>try-finally</code> 块进行回收。</p> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <div class="language-java extra-class"><pre class="language-java"><code>objectThreadLocal<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>userInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
     <span class="token comment">// ...</span>
<span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
     objectThreadLocal<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div></li> <li><p>【强制】高并发时，同步调用应该去考量锁的性能损耗。能用无锁数据结构，就不要用锁；能锁区块，就不要锁整个方法体；能用对象锁，就不要用类锁。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>尽可能使加锁的代码块工作量尽可能的小，避免在锁代码块中调用 <code>RPC</code> 方法。</p></div></li> <li><p>【强制】对多个资源、数据库表、对象同时加锁时，需要<strong>保持一致的加锁顺序</strong>，否则可能会造成死锁。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>线程一需要对表 <code>A、B、C</code> 依次全部加锁后才可以进行更新操作，那么线程二的加锁<strong>顺序也必须是</strong> <code>A、B、C</code>，否则可能出现<strong>死锁</strong>。</p></div></li> <li><p>【强制】在使用阻塞等待获取锁的方式中，必须在 <code>try</code> 代码块之外，并且在加锁方法与 <code>try</code> 代码块之间没有任何可能抛出异常的方法调用，避免加锁成功后，在 <code>finally</code> 中无法解锁。</p> <p>说明一：如果在 <code>lock</code> 方法与 <code>try</code> 代码块之间的方法调用抛出异常，那么无法解锁，造成其它线程无法成功获取锁。</p> <p>说明二：如果 <code>lock</code> 方法在 <code>try</code> 代码块之内，可能由于其它方法抛出异常，导致在 <code>finally</code> 代码块中，<code>unlock</code> 对未加锁的对象解锁，它会调用 <code>AQS</code> 的 <code>tryRelease</code> 方法（取决于具体实现类），抛出 <code>IllegalMonitorStateException</code> 异常。</p> <p>说明三：在 <code>Lock</code> 对象的 <code>lock</code> 方法实现中可能抛出 <code>unchecked</code> 异常，产生的后果与说明二相同。</p> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Lock</span> lock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XxxLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>
lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
     <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token function">doOthers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
     lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
```

</code></pre></div></div> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Lock</span> lock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XxxLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
     <span class="token comment">// 如果此处抛出异常，则直接执行finally代码块</span>
     <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token comment">// 无论加锁是否成功，finally代码块都会执行</span>
     lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token function">doOthers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
     lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div></li> <li><p>【强制】在使用尝试机制来获取锁的方式中，进入业务代码块之前，必须先判断当前线程是否持有锁。锁的释放规则与锁的阻塞等待方式相同。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>Lock 对象的 unlock 方法在执行时，它会调用 AQS 的 tryRelease 方法（取决于具体实现类），如果当前线程不持有锁，则抛出 IllegalMonitorStateException 异常。</p></div> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Lock</span> lock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XxxLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>
<span class="token keyword">boolean</span> isLocked <span class="token operator">=</span> lock<span class="token punctuation">.</span><span class="token function">tryLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>isLocked<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">doOthers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
        lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div></li> <li><p>【强制】并发修改同一记录时，避免更新丢失，需要加锁。要么在应用层加锁，要么在缓存加锁，要么在数据库层使用乐观锁，使用 <code>version</code> 作为更新依据。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>如果每次访问冲突概率小于 <code>20%</code>，推荐使用乐观锁，否则使用悲观锁。乐观锁的重试次数不得小于 <code>3</code> 次。</p></div></li> <li><p>【强制】多线程并行处理定时任务时，<code>Timer</code> 运行多个 <code>TimeTask</code> 时，只要其中之一没有捕获抛出的异常，其它任务便会自动终止运行，使用 <code>ScheduledExecutorService</code> 则没有这个问题。</p></li> <li><p>【推荐】资金相关的金融敏感信息，使用悲观锁策略。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>乐观锁在获得锁的同时已经完成了更新操作，校验逻辑容易出现漏洞，另外，乐观锁对冲突的解决策略有较复杂的要求，处理不当容易造成系统压力或数据异常，所以资金相关的金融敏感信息不使用乐观锁更新。</p></div> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <p>悲观锁遵循<strong>一锁二判三更新四释放</strong>的原则</p></div></li> <li><p>【推荐】使用 <code>CountDownLatch</code> 进行异步转同步操作，每个线程退出前必须调用 <code>countDown</code> 方法，线程执行代码注意 <code>catch</code> 异常，确保 <code>countDown</code> 方法被执行到，避免主线程无法执行至 <code>await</code> 方法直到超时才返回结果。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>注意，子线程抛出异常堆栈，不能在主线程 <code>try-catch</code> 到。</p></div></li> <li><p>【推荐】避免 <code>Random</code> 实例被多线程使用，虽然共享该实例是线程安全的，但会因竞争同一 <code>seed</code> 导致的性能下降。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>Random 实例包括 <code>java.util.Random</code> 的实例或者 <code>Math.random()</code> 的方式。</p></div> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <p>在 JDK7 之后，可以直接使用 API <code>ThreadLocalRandom</code>，而在 JDK7 之前，需要编码保证每个线程持有一个单独的 <code>Random</code> 实例。</p></div></li> <li><p>【推荐】通过双重检查锁（double-checked locking）（在并发场景下）实现延迟初始化的优化问题隐患(可参考 The &quot;Double-Checked Locking is Broken&quot; Declaration)，推荐解决方案中较为简单一种（适用于 JDK 5 及以上版本），将目标属性声明为 <code>volatile</code> 型（比如修改 helper 的属性声明为<code>private volatile Helper helper = null;</code>）。</p> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LazyInitDemo</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Helper</span> helper <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">Helper</span> <span class="token function">getHelper</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>helper <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>helper <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    helper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Helper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> helper<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// other methods and fields...</span>
<span class="token punctuation">}</span>
</code></pre></div></div></li> <li><p>【参考】<code>volatile</code> 解决多线程内存不可见问题。对于一写多读，是可以解决变量同步问题，但是如果多写，同样无法解决线程安全问题。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>如果是 <code>count++</code> 操作，使用如下类实现：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">AtomicInteger</span> count <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AtomicInteger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
count<span class="token punctuation">.</span><span class="token function">addAndGet</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>如果是 JDK8，推荐使用 <code>LongAdder</code> 对象，比 <code>AtomicLong</code> 性能更好（减少乐观锁的重试次数）。</p></div></li> <li><p>【参考】HashMap 在容量不够进行 <code>resize</code> 时由于高并发可能出现死链，导致 CPU 飙升，在开发过程中注意规避此风险。</p></li> <li><p>【参考】ThreadLocal 对象使用 <code>static</code> 修饰，<code>ThreadLocal</code> 无法解决共享对象的更新问题。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>这个变量是针对一个线程内所有操作共享的，所以设置为静态变量，所有此类实例共享此静态变量，也就是说在类第一次被使用时装载，只分配一块存储空间，所有此类的对象(只要是这个线程内定义的)都可以操控这个变量。</p></div></li></ol> <h2 id="八-控制语句"><a href="#八-控制语句" class="header-anchor">#</a> (八) 控制语句</h2> <ol><li><p>【强制】在一个 <code>switch</code> 块内，每个 <code>case</code> 要么通过 <code>continue/break/return</code> 等来终止，要么注释说明程序将继续执行到哪一个 <code>case</code> 为止；在一个 <code>switch</code> 块内，都必须包含一个 <code>default</code> 语句并且放在最后，即使它什么代码也没有。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>注意 <code>break</code> 是退出 <code>switch</code> 语句块，而 <code>return</code> 是<strong>退出方法体</strong>。</p></div></li> <li><p>【强制】当 <code>switch</code> 括号内的变量类型为 <code>String</code> 并且此变量为外部参数时，必须先进行 <code>null</code> 判断。</p> <div class="custom-block danger"><p class="custom-block-title">反例：如下的代码输出是什么？</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SwitchString</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token function">method</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">method</span><span class="token punctuation">(</span><span class="token class-name">String</span> param<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">switch</span> <span class="token punctuation">(</span>param<span class="token punctuation">)</span> <span class="token punctuation">{</span>
             <span class="token comment">// 肯定不是进入这里</span>
             <span class="token keyword">case</span> <span class="token string">&quot;sth&quot;</span><span class="token operator">:</span>
                 <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;it's sth&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                 <span class="token keyword">break</span><span class="token punctuation">;</span>
             <span class="token comment">// 也不是进入这里</span>
             <span class="token keyword">case</span> <span class="token string">&quot;null&quot;</span><span class="token operator">:</span>
                 <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;it's null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token keyword">break</span><span class="token punctuation">;</span>
             <span class="token comment">// 也不是进入这里</span>
             <span class="token keyword">default</span><span class="token operator">:</span>
                 <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;default&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div></li> <li><p>【强制】在 <code>if/else/for/while/do</code> 语句中必须使用大括号。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>即使只有一行代码，禁止不采用大括号的编码方式：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>condition<span class="token punctuation">)</span> statements<span class="token punctuation">;</span>
</code></pre></div></div></li> <li><p>【强制】三目运算符 <code>condition? 表达式 1 : 表达式 2</code> 中，高度注意表达式 1 和 2 在类型对齐时，可能抛出因自动拆箱导致的 NPE 异常。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>以下两种场景会触发类型对齐的拆箱操作：</p> <p>1 ） 表达式 1 或表达式 2 的值只要有一个是原始类型。</p> <p>2 ） 表达式 1 或表达式 2 的值的类型不一致，会强制拆箱升级成表示范围更大的那个类型。</p></div> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Integer</span> a <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">;</span>
<span class="token class-name">Integer</span> b <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">;</span>
<span class="token class-name">Integer</span> c <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token class-name">Boolean</span> flag <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token comment">// a*b 的结果是 int 类型，那么 c 会强制拆箱成 int 类型，抛出 NPE 异常</span>
<span class="token class-name">Integer</span> result<span class="token operator">=</span><span class="token punctuation">(</span>flag<span class="token operator">?</span> a<span class="token operator">*</span>b <span class="token operator">:</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div></li> <li><p>【强制】在高并发场景中，避免使用”<code>等于</code>”判断作为中断或退出的条件。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>如果并发控制没有处理好，容易产生等值判断被“击穿”的情况，使用大于或小于的区间判断条件来代替。</p></div> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <p>判断剩余奖品数量等于 <code>0</code> 时，终止发放奖品，但因为并发处理错误导致奖品数量瞬间变成了负数，这样的话，活动无法终止。</p></div></li> <li><p>【推荐】当某个方法的代码行数超过 <code>10</code> 行时，<code>return / throw</code> 等中断逻辑的右大括号后加一个空行。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>这样做逻辑清晰，有利于代码阅读时重点关注。</p></div></li> <li><p>【推荐】表达异常的分支时，少用 <code>if-else</code> 方式，这种方式可以改写成：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>condition<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">return</span> obj<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 接着写 else 的业务逻辑代码;</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>如果非使用 <code>if()...else if()...else...</code>方式表达逻辑，避免后续代码维护困难，请勿超过 3 层。</p></div> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <p>超过 <code>3</code> 层的 <code>if-else</code> 的逻辑判断代码可以使用<strong>卫语句</strong>、<strong>策略模式</strong>、<strong>状态模式</strong>等来实现，其中卫语句
示例如下：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> findBoyfriend <span class="token punctuation">(</span><span class="token class-name">Man</span> man<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>man<span class="token punctuation">.</span><span class="token function">isUgly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;本姑娘是外貌协会的资深会员&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>man<span class="token punctuation">.</span><span class="token function">isPoor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;贫贱夫妻百事哀&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>man<span class="token punctuation">.</span><span class="token function">isBadTemper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;银河有多远，你就给我滚多远&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;可以先交往一段时间看看&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div></li> <li><p>【推荐】除常用方法（如 getXxx/isXxx）等外，不要在条件判断中执行其它复杂的语句，将复杂逻辑判断的结果赋值给一个有意义的布尔变量名，以提高可读性。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>很多 <code>if</code> 语句内的逻辑表达式相当复杂，与、或、取反混合运算，甚至各种方法纵深调用，理解成本非常高。</p> <p>如果赋值一个非常好理解的布尔变量名字，则是件令人爽心悦目的事情。</p></div> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 伪代码如下</span>
<span class="token keyword">final</span> <span class="token keyword">boolean</span> existed <span class="token operator">=</span> <span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token keyword">open</span><span class="token punctuation">(</span>fileName<span class="token punctuation">,</span> <span class="token string">&quot;w&quot;</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>existed<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">acquire</span><span class="token punctuation">(</span><span class="token keyword">long</span> arg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">tryAcquire</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">acquireQueued</span><span class="token punctuation">(</span><span class="token function">addWaiter</span><span class="token punctuation">(</span><span class="token class-name">Node</span><span class="token punctuation">.</span>EXCLUSIVE<span class="token punctuation">)</span><span class="token punctuation">,</span> arg<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token function">selfInterrupt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div></li> <li><p>【推荐】不要在其它表达式（尤其是条件表达式）中，插入赋值语句。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>赋值点类似于人体的穴位，对于代码的理解至关重要，所以赋值语句需要清晰地单独成为一行。</p></div> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">Lock</span> <span class="token function">getLock</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> fair<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">// 算术表达式中出现赋值操作，容易忽略count值已经被改变</span>
threshold <span class="token operator">=</span> <span class="token punctuation">(</span>count <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token punctuation">;</span>
<span class="token comment">// 条件表达式中出现赋值操作，容易误认为是sync==fair</span>
<span class="token keyword">return</span> <span class="token punctuation">(</span>sync <span class="token operator">=</span> fair<span class="token punctuation">)</span><span class="token operator">?</span> <span class="token keyword">new</span> <span class="token class-name">FairSync</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">NonfairSync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div></li> <li><p>【推荐】循环体中的语句要考量性能，以下操作尽量移至循环体外处理，如定义对象、变量、获取数据库连接，进行不必要的 <code>try-catch</code> 操作（这个 <code>try-catch</code> 是否可以移至循环体外）。</p></li> <li><p>【推荐】避免采用取反逻辑运算符。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>取反逻辑不利于快速理解，并且取反逻辑写法必然存在对应的正向逻辑写法。</p></div> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <p>使用 if (x &lt; 628) 来表达 x 小于 628 。</p></div> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <p>使用 if (!(x &gt;= 628)) 来表达 x 小于 628 。</p></div></li> <li><p>【推荐】<strong>接口入参保护</strong>，这种场景常见的是用作批量操作的接口。</p> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <p>某业务系统，提供一个用户批量查询的接口，API 文档上有说最多查多少个，但接口实现上没做任何保护，导致调用方传了一个 1000 的用户 id 数组过来后，查询信息后，内存爆了。</p></div></li> <li><p>【参考】下列情形，需要进行参数校验：</p> <p>1 ） 调用频次低的方法。</p> <p>2 ） 执行时间开销很大的方法。此情形中，参数校验时间几乎可以忽略不计，但如果因为参数错误导致中间执行回退，或者错误，那得不偿失。</p> <p>3 ） 需要极高稳定性和可用性的方法。</p> <p>4 ） 对外提供的开放接口，不管是 RPC/API/HTTP 接口。</p> <p>5 ） 敏感权限入口。</p></li> <li><p>【参考】下列情形，不需要进行参数校验：</p> <p>1 ） 极有可能被循环调用的方法。但在方法说明里必须注明外部参数检查。</p> <p>2 ） 底层调用频度比较高的方法。毕竟是像纯净水过滤的最后一道，参数错误不太可能到底层才会暴露问题。一般 <code>DAO</code> 层与 <code>Service</code> 层都在同一个应用中，部署在同一台服务器中，所以 <code>DAO</code> 的参数校验，可以省略。</p> <p>3 ） 被声明成 <code>private</code> 只会被自己代码所调用的方法，如果能够确定调用方法的代码传入参数已经做过检查或者肯定不会有问题，此时可以不校验参数。</p></li></ol> <h2 id="九-注释规约"><a href="#九-注释规约" class="header-anchor">#</a> (九) 注释规约</h2> <ol><li><p>【强制】类、类属性、类方法的注释必须使用 <code>Javadoc</code> 规范，使用<code>/**内容**/</code>格式，不得使用 <code>// xxx</code> 方式。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>在 IDE <code>编辑窗口中，Javadoc</code> 方式会提示相关注释，生成 <code>Javadoc</code> 可以正确输出相应注释；</p> <p>在 IDE 中，工程调用方法时，不进入方法即可悬浮提示方法、参数、返回值的意义，提高阅读效率。</p></div></li> <li><p>【强制】所有的抽象方法（包括接口中的方法）必须要用 <code>Javadoc</code> 注释、除了返回值、参数、异常说明外，还必须指出该方法做什么事情，实现什么功能。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>对子类的实现要求，或者调用注意事项，请一并说明。</p></div></li> <li><p>【强制】所有的类都必须添加创建者和创建日期。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>在设置模板时，注意 IDEA 的 @author 为<code>${USER}</code>，而 eclipse 的 @author 为<code>${user}</code>，大小写有区别，而日期的设置统一为 <code>yyyy/MM/dd</code> 的格式。</p></div> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
* @author yangguanbao
* @date 2016/10/31
*/</span>
</code></pre></div></div></li> <li><p>【强制】方法内部单行注释，在被注释语句上方另起一行，使用<code>//</code>注释。方法内部多行注释使用<code>/* */</code>注释，注意与代码对齐。</p></li> <li><p>【强制】所有的枚举类型字段必须要有注释，说明每个数据项的用途。</p></li> <li><p>【推荐】与其“半吊子”英文来注释，不如用中文注释把问题说清楚。专有名词与关键字保持英文原文即可。</p> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <p>“TCP 连接超时”解释成“传输控制协议连接超时”，理解反而费脑筋。</p></div></li> <li><p>【推荐】代码修改的同时，注释也要进行相应的修改，尤其是参数、返回值、异常、核心逻辑等的修改。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>代码与注释更新不同步，就像路网与导航软件更新不同步一样，如果导航软件严重滞后，就失去了导航的意义。</p></div></li> <li><p>【推荐】在类中删除未使用的任何字段和方法；在方法中删除未使用的任何参数声明与内部变量。</p></li> <li><p>【参考】谨慎注释掉代码。在上方详细说明，而不是简单地注释掉。如果无用，则删除。</p> <div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>代码被注释掉有两种可能性：</p> <p>1 ）后续会恢复此段代码逻辑。</p> <p>2 ）永久不用。</p> <p>前者如果没有备注信息，难以知晓注释动机。后者建议直接删掉即可，假如需要查阅历史代码，登录代码仓库即可。</p></div></li> <li><p>【参考】对于注释的要求：</p> <p>第一、能够准确反映设计思想和代码逻辑；</p> <p>第二、能够描述业务含义，使别的程序员能够迅速了解到代码背后的信息。</p> <p>完全没有注释的大段代码对于阅读者形同天书，注释是给自己看的，即使隔很长时间，也能清晰理解当时的思路；</p> <p>注释也是给继任者看的，使其能够快速接替自己的工作。</p></li> <li><p>【参考】好的命名、代码结构是自解释的，注释力求精简准确、表达到位。避免出现注释的一个极端：过多过滥的注释，代码的逻辑一旦修改，修改注释是相当大的负担。</p> <div class="custom-block danger"><p class="custom-block-title">反例：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// put elephant into fridge</span>
<span class="token function">put</span><span class="token punctuation">(</span>elephant<span class="token punctuation">,</span> fridge<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>方法名 put，加上两个有意义的变量名 elephant 和 fridge，已经说明了这是在干什么，语义清晰的代码不需要额外的注释。</p></div></li> <li><p>【参考】特殊注释标记，请注明标记人与标记时间。注意及时处理这些标记，通过标记扫描，经常清理此类标记。线上故障有时候就是来源于这些标记处的代码。</p> <p>1 ） 待办事宜（TODO）:（标记人，标记时间，[预计处理时间]）表示需要实现，但目前还未实现的功能。这实际上是一个 Javadoc 的标签，目前的 Javadoc 还没有实现，但已经被广泛使用。只能应用于类，接口和方法（因为它是一个 Javadoc 标签）。</p> <p>2 ） 错误，不能工作（FIXME）:（标记人，标记时间，[预计处理时间]）在注释中用 FIXME 标记某代码是错误的，而且不能工作，需要及时纠正的情况。</p></li></ol> <h2 id="十-其它"><a href="#十-其它" class="header-anchor">#</a> (十) 其它</h2> <ol><li>【强制】在使用正则表达式时，利用好其预编译功能，可以有效加快正则匹配速度。<div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>不要在方法体内定义：Pattern pattern = Pattern.compile(“规则”);</p></div></li> <li>【强制】避免用 Apache Beanutils 进行属性的 copy。<div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>Apache BeanUtils 性能较差，可以使用其他方案比如 Spring BeanUtils, Cglib BeanCopier，注意均是浅拷贝。</p></div></li> <li>【强制】<code>velocity</code> 调用 <code>POJO</code> 类的属性时，直接使用属性名取值即可，模板引擎会自动按规范调用 <code>POJO</code> 的 <code>getXxx()</code>，如果是 <code>boolean</code> 基本数据类型变量（boolean 命名不需要加 is 前缀），会自动调用 <code>isXxx()</code>方法。<div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>注意如果是 <code>Boolean</code> 包装类对象，优先调用 <code>getXxx()</code>的方法。</p></div></li> <li>【强制】后台输送给页面的变量必须加<code>$!{var}</code>——中间的感叹号。<div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>如果 <code>var</code> 等于 <code>null</code> 或者不存在，那么<code>${var}</code>会直接显示在页面上。</p></div></li> <li>【强制】注意 <code>Math.random()</code> 这个方法返回是 <code>double</code> 类型，注意取值的范围 <code>0≤x&lt;1</code>（能够取到零值，注意除零异常），如果想获取整数类型的随机数，不要将 <code>x</code> 放大 <code>10</code> 的若干倍然后取整，直接使用 <code>Random</code> 对象的 <code>nextInt</code> 或者 <code>nextLong</code> 方法。</li> <li>【推荐】不要在视图模板中加入任何复杂的逻辑。<div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>根据 MVC 理论，视图的职责是展示，不要抢模型和控制器的活。</p></div></li> <li>【推荐】任何数据结构的构造或初始化，都应指定大小，避免数据结构无限增长吃光内存。</li> <li>【推荐】及时清理不再使用的代码段或配置信息。<div class="custom-block warning"><p class="custom-block-title">说明：</p> <p>对于垃圾代码或过时配置，坚决清理干净，避免程序过度臃肿，代码冗余。</p></div> <div class="custom-block tip"><p class="custom-block-title">正例:</p> <p>对于暂时被注释掉，后续可能恢复使用的代码片断，在注释代码上方，统一规定使用三个斜杠(<code>///</code>)来说明注释掉代码的理由。如：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token comment">/// 业务方通知活动暂停</span>
     <span class="token comment">// Business business = new Business();</span>
     <span class="token comment">// business.active();</span>
     <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;it's finished&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div></li></ol></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/programmingStyle/java.programming.style/edit/master/alibaba/java-specification.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2020-4-29 09:11:06</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/alibaba/" class="prev router-link-active">
        前言
      </a></span> <span class="next"><a href="/alibaba/exception-log-specification.html">
        二、异常日志
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.ebef3189.js" defer></script><script src="/assets/js/2.6bb482e9.js" defer></script><script src="/assets/js/11.e3e93c84.js" defer></script>
  </body>
</html>
